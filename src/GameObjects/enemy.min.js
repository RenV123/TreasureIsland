import{Vector2D}from"../Helpers/vector2D.js";import{colorShade,PathWayFinder,getRandomNr,shuffleArray}from"../Helpers/helperlib.js";import{GameObject,DrawTypes}from"./gameObject.js";export class Enemy extends GameObject{type=DrawTypes.IMG;color="#F94144";whiteListedTiles=["Grass"];constructor(e,t,s,o,r,h){super(s,o,r,h),this._gameboard=e,this._treasureHunter=t,this.imgSrc="./img/tile-enemy-1.webp",this._changeOfStepTowardsPlayer=75,this._changeWhenClose=15}moveToTreasureHunter(){let e=new PathWayFinder(this._gameboard,this.whiteListedTiles).findShortestPath(this.pos,this._treasureHunter.pos);window.DEBUG_MODE&&e.listOfCheckedSpots.forEach((e=>{this._gameboard.getTile(e.x,e.y).color="#7EB356"}));let t=0==e.goodPaths.length?100:getRandomNr(0,100);if(e.goodPaths?.[0]?.length<5?t-=this._changeWhenClose:t+=this._changeWhenClose,t>this._changeOfStepTowardsPlayer){let t=shuffleArray([this._gameboard.getTile(this.x+1,this.y),this._gameboard.getTile(this.x-1,this.y),this._gameboard.getTile(this.x,this.y+1),this._gameboard.getTile(this.x,this.y-1)]).find((t=>t&&this.whiteListedTiles.includes(t.constructor.name)&&!Vector2D.equals(t.pos,e.goodPaths?.[0]?.[1])&&!Vector2D.equals(t.pos,this._treasureHunter.pos)));t&&(this.x=t.x,this.y=t.y,window.DEBUG_MODE&&(t.color="darkred"))}else if(e.goodPaths?.[0]?.length>0&&(e.goodPaths[0][1].x==this._treasureHunter.x&&e.goodPaths[0][1].y==this._treasureHunter.y||(this.x=e.goodPaths[0][1].x,this.y=e.goodPaths[0][1].y),window.DEBUG_MODE)){let t="#99c24750";e.goodPaths.reverse().forEach((e=>{t=colorShade(t,10),e.forEach((e=>{this._gameboard.getTile(e.x,e.y).color=t}))}))}}}